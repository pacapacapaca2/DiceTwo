<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Профиль - DiceTwo</title>
    <link rel="stylesheet" href="assets/css/style.css">
    <!-- Подключение TON Connect SDK -->
    <script src="./ton-connect-sdk.js"></script>
    <!-- Настройка модуля TON Connect -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof window.TonConnectSDK !== 'undefined') {
                console.log('TON Connect SDK успешно загружен:', window.TonConnectSDK);
            } else {
                console.error('Ошибка: TON Connect SDK не загружен!');
                
                // Создаем элемент ошибки и кнопку перезагрузки
                const errorContainer = document.createElement('div');
                errorContainer.className = 'error-container';
                errorContainer.style.cssText = 'background: #ffebee; padding: 20px; border-radius: 8px; margin: 20px auto; max-width: 90%; text-align: center; box-shadow: 0 2px 10px rgba(0,0,0,0.1);';
                
                const errorMessage = document.createElement('p');
                errorMessage.textContent = 'Не удалось загрузить TON Connect SDK. Пожалуйста, перезагрузите страницу.';
                errorMessage.style.cssText = 'color: #d32f2f; font-weight: bold; margin-bottom: 15px;';
                
                const reloadButton = document.createElement('button');
                reloadButton.textContent = 'Перезагрузить';
                reloadButton.style.cssText = 'background: #2196f3; color: white; border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer; font-weight: bold;';
                reloadButton.onclick = function() {
                    window.location.reload();
                };
                
                errorContainer.appendChild(errorMessage);
                errorContainer.appendChild(reloadButton);
                
                // Добавляем контейнер ошибки в начало body
                document.body.insertBefore(errorContainer, document.body.firstChild);
            }
        });
    </script>
    
    <!-- Скрипты приложения -->
    <script src="assets/js/ton-connector.js"></script>
    <script src="wallet-connect.js"></script>
    <script src="assets/js/profile.js"></script>
</head>
<body class="profile-page">
    <div class="container profile-container">
        <header class="profile-header">
            <h1>Профиль игрока</h1>
            <div class="back-button" onclick="window.location.href='../'">
                <span>&larr;</span> Назад
            </div>
        </header>
        
        <main>
            <section class="wallet-section">
                <h2>Ваш кошелек</h2>
                <div class="wallet-status">
                    <div id="wallet-not-connected" class="wallet-status-message">
                        <p>Кошелек не подключен</p>
                        <button id="connect-wallet-button" class="connect-wallet-btn">Подключить кошелек</button>
                    </div>
                    <div id="wallet-connected" class="wallet-status-message" style="display: none;">
                        <div class="wallet-info">
                            <div class="wallet-name">
                                <img id="wallet-icon" src="assets/img/wallet-icon.svg" alt="Wallet">
                                <span id="wallet-name">Telegram Wallet</span>
                            </div>
                            <div class="wallet-address" id="wallet-address">EQD...</div>
                        </div>
                        <div class="wallet-actions">
                            <button id="disconnect-wallet-button" class="disconnect-wallet-btn">Отключить</button>
                        </div>
                    </div>
                </div>
            </section>
            
            <section class="wallet-select" id="wallet-select" style="display: none;">
                <h3>Выберите кошелек</h3>
                <div class="wallets-list" id="wallets-list">
                    <!-- Wallet list items will be added here dynamically -->
                </div>
            </section>
            
            <section class="game-stats">
                <h2>Статистика игры</h2>
                <div class="stats-grid">
                    <div class="stat-item">
                        <div class="stat-value" id="total-games">0</div>
                        <div class="stat-label">Всего игр</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="wins">0</div>
                        <div class="stat-label">Побед</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="win-rate">0%</div>
                        <div class="stat-label">Винрейт</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="ton-won">0 TON</div>
                        <div class="stat-label">Выиграно</div>
                    </div>
                </div>
            </section>
            
            <section class="game-history">
                <h2>История игр</h2>
                <div class="history-list" id="game-history-list">
                    <div class="empty-history-message">
                        История игр пуста
                    </div>
                    <!-- Game history items will be added here dynamically -->
                </div>
            </section>
        </main>
        
        <footer class="profile-footer">
            <p>&copy; 2023 DiceTwo - Игра в кости на блокчейне TON</p>
        </footer>
    </div>
    
    <script>
        // Инициализация при загрузке страницы
        document.addEventListener('DOMContentLoaded', function() {
            console.log('TON Connect SDK успешно загружен:', window.TonConnectSDK || 'TonConnect');
        });
    </script>
</body>
</html>
